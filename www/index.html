<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skat AI (WASM)</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="app">
        <header>
            <h1>Skat AI vs God Mode</h1>
            <div id="game-status">Loading WASM...</div>
        </header>

        <main id="game-board">
            <!-- Opponents (Top) -->
            <div id="opponents-area">
                <div class="opponent" id="opponent-left">
                    <div class="hand-container" id="hand-left">
                        <div class="hand-back">
                            <div class="points-badge" id="left-points" style="display:none">0</div>
                        </div>
                    </div>
                    <span>Left (AI)</span>
                </div>
                <div class="opponent" id="opponent-right">
                    <div class="hand-container" id="hand-right">
                        <div class="hand-back">
                            <div class="points-badge" id="right-points" style="display:none">0</div>
                        </div>
                    </div>
                    <span>Right (AI)</span>
                </div>
            </div>

            <!-- Table (Center) -->
            <div id="table-area">
                <div id="skat-display"></div>
                <div id="game-table">
                    <div id="trick-cards"></div>
                    <div id="game-over-overlay" style="display: none;">
                        <div id="game-result-message"></div>
                        <div id="game-result-score"></div>
                    </div>
                </div>
            </div>

            <!-- Player (Bottom) -->
            <div id="player-area">
                <div id="player-info">
                    <span>Declarer (You)</span>
                    <div id="my-tricks-pile" class="hand-back" style="display:none; margin-left: 10px;">
                        <div class="points-badge" id="my-points">0</div>
                    </div>
                </div>
                <div id="my-hand"></div>
            </div>
        </main>

        <!-- Controls -->
        <div id="controls-area">
            <button id="btn-new-game">Neues Spiel</button>
            <button id="btn-cheat">Karten zeigen</button>
            <button id="btn-hint">Tipp</button>
            <button id="btn-undo">Zug zurück</button>
            <button id="btn-settings" class="icon-btn" title="Settings">⚙️</button>
        </div>

        <aside id="info-panel">
            <div id="analysis">
                <h3>Analysis</h3>
                <div>Value: --</div>
                <div>Loss: --</div>
                <hr>
            </div>
        </aside>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content" style="max-width: 500px; height: auto;">
                <h2>Settings</h2>
                
                <div class="settings-group">
                    <label>Deck Style:</label>
                    <div class="settings-row">
                        <label><input type="radio" name="deck-style" value="french" checked> French</label>
                        <label><input type="radio" name="deck-style" value="german"> German</label>
                    </div>
                </div>

                <div class="settings-group">
                    <label>Card Display:</label>
                    <div class="settings-row">
                        <label><input type="radio" name="card-display" value="css" checked> Classic (CSS)</label>
                        <label><input type="radio" name="card-display" value="image"> Image</label>
                    </div>
                </div>

                <div class="settings-group">
                    <label>Image Type:</label>
                    <div class="settings-row">
                        <label><input type="radio" name="image-type" value="full" checked> Full Scan</label>
                        <label><input type="radio" name="image-type" value="tile"> Tile</label>
                    </div>
                </div>

                <button id="btn-close-settings" style="margin-top: 20px;">Close</button>
            </div>
        </div>

        <!-- Game Selection Modal -->
        <div id="game-selection-modal" class="modal-overlay">
            <div class="modal-content">
                <h2>Game Setup (12 Cards)</h2>
                <div id="selection-hand-container">
                    <!-- Hand Cards -->
                </div>

                <p style="margin-top:0; color:#ccc; font-size:0.9em;">Click to move to Skat (Max 2)</p>

                <div id="selection-skat-container">
                    <!-- Skat Cards -->
                    <span style="color:#aaa; font-style:italic;">Empty Skat</span>
                </div>

                <div class="selection-controls">
                    <!-- <p>Select 2 cards to discard into Skat.</p> REMOVED, implied by UI -->
                    <!-- <div id="selected-skat-display">Skat: [ ] [ ]</div> REMOVED -->

                    <div class="game-type-selector">
                        <fieldset id="game-type-radios">
                            <legend>Game Type</legend>
                            <label><input type="radio" name="game-type" value="Grand"> Grand</label>
                            <label><input type="radio" name="game-type" value="Clubs" checked> Clubs</label>
                            <label><input type="radio" name="game-type" value="Spades"> Spades</label>
                            <label><input type="radio" name="game-type" value="Hearts"> Hearts</label>
                            <label><input type="radio" name="game-type" value="Diamonds"> Diamonds</label>
                            <label><input type="radio" name="game-type" value="Null"> Null</label>
                        </fieldset>
                    </div>

                    <button id="btn-calc-best">Calculate Best Game</button>
                    <button id="btn-start-game" disabled>Start Game</button>
                </div>

                <div id="best-game-results" style="display:none; margin-top: 15px;">
                    <h3>Best Game Analysis</h3>
                    <table id="best-game-table">
                        <thead>
                            <tr>
                                <th>Game</th>
                                <th>Win?</th>
                                <th>Value</th>
                                <th>Skat</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Load WASM -->
    <script type="module" src="index.js"></script>
</body>

</html>